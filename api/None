INFO     2024-06-23 17:24:08.786 request id: app - uvicorn.server:_serve - Started server process [160]
INFO     2024-06-23 17:24:08.787 request id: app - uvicorn.server:_serve - Started server process [160]
INFO     2024-06-23 17:24:08.787 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:24:08.788 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:24:08.849 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 17:24:09.019 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 17:24:09.076 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 17:24:09.081 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:24:09.082 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:26:08.228 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:26:08.229 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:26:08.331 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:26:08.332 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:26:44.670 request id: app - uvicorn.server:_serve - Started server process [210]
INFO     2024-06-23 17:26:44.671 request id: app - uvicorn.server:_serve - Started server process [210]
INFO     2024-06-23 17:26:44.671 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:26:44.672 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:26:44.729 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 17:26:44.900 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 17:26:44.944 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 17:26:44.947 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:26:44.948 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:26:47.676 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:26:47.677 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:26:47.779 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:26:47.781 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:27:03.235 request id: app - uvicorn.server:_serve - Started server process [239]
INFO     2024-06-23 17:27:03.235 request id: app - uvicorn.server:_serve - Started server process [239]
INFO     2024-06-23 17:27:03.236 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:27:03.236 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:27:03.293 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 17:27:03.465 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 17:27:20.065 request id: app - uvicorn.server:_serve - Started server process [268]
INFO     2024-06-23 17:27:20.065 request id: app - uvicorn.server:_serve - Started server process [268]
INFO     2024-06-23 17:27:20.066 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:27:20.066 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:27:20.124 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 17:27:20.298 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 17:27:20.345 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 17:27:20.348 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:27:20.350 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:27:21.162 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:27:21.164 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:27:21.269 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:27:21.270 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:27:37.305 request id: app - uvicorn.server:_serve - Started server process [297]
INFO     2024-06-23 17:27:37.305 request id: app - uvicorn.server:_serve - Started server process [297]
INFO     2024-06-23 17:27:37.306 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:27:37.306 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:27:37.369 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 17:27:37.542 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 17:27:37.589 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 17:27:37.592 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:27:37.593 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:28:12.546 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:28:12.547 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:28:12.650 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:28:12.651 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:28:12.656 request id: app - uvicorn.lifespan.on:shutdown - Application shutdown complete.
INFO     2024-06-23 17:28:28.566 request id: app - uvicorn.server:_serve - Started server process [326]
INFO     2024-06-23 17:28:28.567 request id: app - uvicorn.server:_serve - Started server process [326]
INFO     2024-06-23 17:28:28.568 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:28:28.568 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:28:28.626 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 17:28:28.809 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 17:28:28.867 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 17:28:44.827 request id: app - uvicorn.server:_serve - Started server process [355]
INFO     2024-06-23 17:28:44.827 request id: app - uvicorn.server:_serve - Started server process [355]
INFO     2024-06-23 17:28:44.828 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:28:44.828 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:28:44.885 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 17:28:45.062 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 17:28:45.123 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 17:28:45.126 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:29:00.840 request id: app - uvicorn.server:_serve - Started server process [384]
INFO     2024-06-23 17:29:00.841 request id: app - uvicorn.server:_serve - Started server process [384]
INFO     2024-06-23 17:29:00.842 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:29:00.842 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:29:00.898 request id: app - app.config.mongo:init - Successfully connected to mongodb database
INFO     2024-06-23 17:29:16.992 request id: app - uvicorn.server:_serve - Started server process [414]
INFO     2024-06-23 17:29:16.993 request id: app - uvicorn.server:_serve - Started server process [414]
INFO     2024-06-23 17:29:16.994 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:29:16.998 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:29:17.101 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 17:29:17.302 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 17:29:17.367 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 17:29:17.371 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:29:17.372 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:29:22.827 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:29:22.828 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:29:22.930 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:29:22.931 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:29:36.946 request id: app - uvicorn.server:_serve - Started server process [443]
INFO     2024-06-23 17:29:36.946 request id: app - uvicorn.server:_serve - Started server process [443]
INFO     2024-06-23 17:29:36.947 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:29:36.947 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:29:37.019 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 17:29:37.238 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 17:29:37.321 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 17:29:37.325 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:29:37.326 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:29:42.437 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:48168 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 17:29:42.454 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:48176 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 17:29:42.464 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:48164 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 17:29:42.485 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:48190 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 17:34:50.610 request id: app - httpx._client:_send_single_request - HTTP Request: GET http://qdrant:6333/collections/qdr/exists "HTTP/1.1 200 OK"
INFO     2024-06-23 17:34:50.976 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO     2024-06-23 17:34:50.996 request id: app - httpx._client:_send_single_request - HTTP Request: POST http://qdrant:6333/collections/qdr/points/search "HTTP/1.1 200 OK"
INFO     2024-06-23 17:34:51.069 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:44506 - "POST /api/chat/message HTTP/1.0" 200
INFO     2024-06-23 17:34:52.110 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO     2024-06-23 17:35:16.693 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:35:16.694 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:35:16.796 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:35:16.798 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:35:33.482 request id: app - uvicorn.server:_serve - Started server process [475]
INFO     2024-06-23 17:35:33.483 request id: app - uvicorn.server:_serve - Started server process [475]
INFO     2024-06-23 17:35:33.483 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:35:33.484 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:35:33.544 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 17:35:33.732 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 17:35:33.795 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 17:35:33.800 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:35:33.802 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:35:33.810 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:58742 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 17:35:33.823 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:50534 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 17:35:33.829 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:58754 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 17:35:33.847 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:50536 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 17:35:42.548 request id: app - httpx._client:_send_single_request - HTTP Request: GET http://qdrant:6333/collections/qdr/exists "HTTP/1.1 200 OK"
INFO     2024-06-23 17:35:42.821 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO     2024-06-23 17:35:42.838 request id: app - httpx._client:_send_single_request - HTTP Request: POST http://qdrant:6333/collections/qdr/points/search "HTTP/1.1 200 OK"
INFO     2024-06-23 17:35:43.471 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/completions "HTTP/1.1 404 Not Found"
INFO     2024-06-23 17:35:43.493 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:52382 - "POST /api/chat/message HTTP/1.0" 500
ERROR    2024-06-23 17:35:43.496 request id: app - uvicorn.protocols.http.httptools_impl:run_asgi - Exception in ASGI application

Traceback (most recent call last):

  File "/app/app/routers/chat.py", line 333, in process_message
    response = rag_pipeline.query(message, precision=PRECISION)
               │            │     │                  └ '5'
               │            │     └ "C'est quoi un AAE ?"
               │            └ <function CheckerRAGPipeline.query at 0x7f8ddde549d0>
               └ <app.ds.rag_pipeline.CheckerRAGPipeline object at 0x7f8dbbec5480>

  File "/app/app/ds/rag_pipeline.py", line 246, in query
    return query_engine.run(query_str=message)
           │            │             └ "C'est quoi un AAE ?"
           │            └ <function QueryPipeline.run at 0x7f8ddde13f40>
           └ QueryPipeline(partial_dict={}, callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, m...

  File "/usr/local/lib/python3.10/site-packages/llama_index/core/query_pipeline/query.py", line 321, in run
    outputs, _ = self._run(
                 │    └ <function QueryPipeline._run at 0x7f8ddde28820>
                 └ QueryPipeline(partial_dict={}, callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, m...
  File "/usr/local/lib/python3.10/site-packages/llama_index/core/query_pipeline/query.py", line 673, in _run
    result_outputs, intermediates = self._run_multi(
                                    │    └ <function QueryPipeline._run_multi at 0x7f8ddde28b80>
                                    └ QueryPipeline(partial_dict={}, callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, m...
  File "/usr/local/lib/python3.10/site-packages/llama_index/core/query_pipeline/query.py", line 876, in _run_multi
    output_dict = module.run_component(**module_input)
                  │      │               └ {'prompt': "You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces o...
                  │      └ <function QueryComponent.run_component at 0x7f8e9cf8c4c0>
                  └ LLMCompleteComponent(partial_dict={}, llm=OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object...
  File "/usr/local/lib/python3.10/site-packages/llama_index/core/base/query_pipeline/query.py", line 199, in run_component
    component_outputs = self._run_component(**kwargs)
                        │    │                └ {'prompt': "You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces o...
                        │    └ <function LLMCompleteComponent._run_component at 0x7f8e9d01feb0>
                        └ LLMCompleteComponent(partial_dict={}, llm=OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object...
  File "/usr/local/lib/python3.10/site-packages/llama_index/core/llms/llm.py", line 725, in _run_component
    response = self.llm.complete(prompt, formatted=True)
               │    │   │        └ "You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces of context.\...
               │    │   └ <FunctionWrapper at 0x7f8de062be20 for function at 0x7f8de068dbd0>
               │    └ OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, system_prompt=None, m...
               └ LLMCompleteComponent(partial_dict={}, llm=OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object...
  File "/usr/local/lib/python3.10/site-packages/llama_index/core/instrumentation/dispatcher.py", line 230, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {'formatted': True}
             │     └ ("You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces of context....
             └ <bound method OpenAILike.complete of OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0...
  File "/usr/local/lib/python3.10/site-packages/llama_index/llms/openai_like/base.py", line 88, in complete
    return super().complete(prompt, **kwargs)
                            │         └ {}
                            └ "You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces of context.\...
  File "/usr/local/lib/python3.10/site-packages/llama_index/core/instrumentation/dispatcher.py", line 230, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ("You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces of context....
             └ <bound method OpenAI.complete of OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8...
  File "/usr/local/lib/python3.10/site-packages/llama_index/core/llms/callbacks.py", line 429, in wrapped_llm_predict
    f_return_val = f(_self, *args, **kwargs)
                   │ │       │       └ {}
                   │ │       └ ("You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces of context....
                   │ └ OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, system_prompt=None, m...
                   └ <function OpenAI.complete at 0x7f8e8bee7d90>
  File "/usr/local/lib/python3.10/site-packages/llama_index/llms/openai/base.py", line 332, in complete
    return complete_fn(prompt, **kwargs)
           │           │         └ {}
           │           └ "You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces of context.\...
           └ <bound method OpenAI._complete of OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f...
  File "/usr/local/lib/python3.10/site-packages/llama_index/llms/openai/base.py", line 96, in wrapper
    return retry(f)(self, *args, **kwargs)
           │     │  │      │       └ {}
           │     │  │      └ ("You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces of context....
           │     │  └ OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, system_prompt=None, m...
           │     └ <function OpenAI._complete at 0x7f8e8befc670>
           └ <function retry.<locals>.wrap at 0x7f8dbbd693f0>
  File "/usr/local/lib/python3.10/site-packages/tenacity/__init__.py", line 330, in wrapped_f
    return self(f, *args, **kw)
           │    │   │       └ {}
           │    │   └ (OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, system_prompt=None, ...
           │    └ <function OpenAI._complete at 0x7f8e8befc670>
           └ <Retrying object at 0x7f8dbbd6f310 (stop=<tenacity.stop.stop_any object at 0x7f8dbbd6fc10>, wait=<tenacity.wait.wait_random_e...
  File "/usr/local/lib/python3.10/site-packages/tenacity/__init__.py", line 467, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 140246718539872: attempt #1; slept for 0.0; last result: failed (NotFoundError Error code: 404 - {'error': {'...
         │    └ <function BaseRetrying.iter at 0x7f8e90ebaf80>
         └ <Retrying object at 0x7f8dbbd6f310 (stop=<tenacity.stop.stop_any object at 0x7f8dbbd6fc10>, wait=<tenacity.wait.wait_random_e...
  File "/usr/local/lib/python3.10/site-packages/tenacity/__init__.py", line 368, in iter
    result = action(retry_state)
             │      └ <RetryCallState 140246718539872: attempt #1; slept for 0.0; last result: failed (NotFoundError Error code: 404 - {'error': {'...
             └ <function BaseRetrying._post_retry_check_actions.<locals>.<lambda> at 0x7f8dbbd76c20>
  File "/usr/local/lib/python3.10/site-packages/tenacity/__init__.py", line 390, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                 │   │  │       └ <function Future.result at 0x7f8ed4648040>
                                 │   │  └ <Future at 0x7f8dbaa87730 state=finished raised NotFoundError>
                                 │   └ <RetryCallState 140246718539872: attempt #1; slept for 0.0; last result: failed (NotFoundError Error code: 404 - {'error': {'...
                                 └ <RetryCallState 140246718539872: attempt #1; slept for 0.0; last result: failed (NotFoundError Error code: 404 - {'error': {'...
  File "/usr/local/lib/python3.10/concurrent/futures/_base.py", line 451, in result
    return self.__get_result()
           └ None
  File "/usr/local/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
    raise self._exception
          └ None
  File "/usr/local/lib/python3.10/site-packages/tenacity/__init__.py", line 470, in __call__
    result = fn(*args, **kwargs)
             │   │       └ {}
             │   └ (OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, system_prompt=None, ...
             └ <function OpenAI._complete at 0x7f8e8befc670>
  File "/usr/local/lib/python3.10/site-packages/llama_index/llms/openai/base.py", line 514, in _complete
    response = client.completions.create(
               │      │           └ <function Completions.create at 0x7f8e90a1fd90>
               │      └ <openai.resources.completions.Completions object at 0x7f8dca23f460>
               └ <openai.OpenAI object at 0x7f8dbbd6e3b0>
  File "/usr/local/lib/python3.10/site-packages/openai/_utils/_utils.py", line 275, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'prompt': "You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces o...
           │     └ (<openai.resources.completions.Completions object at 0x7f8dca23f460>,)
           └ <function Completions.create at 0x7f8e90a1fd00>
  File "/usr/local/lib/python3.10/site-packages/openai/resources/completions.py", line 506, in create
    return self._post(
           │    └ <bound method SyncAPIClient.post of <openai.OpenAI object at 0x7f8dbbd6e3b0>>
           └ <openai.resources.completions.Completions object at 0x7f8dca23f460>
  File "/usr/local/lib/python3.10/site-packages/openai/_base_client.py", line 1200, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
           │    │          │    │       │        │            │                  └ openai.Stream[openai.types.completion.Completion]
           │    │          │    │       │        │            └ False
           │    │          │    │       │        └ FinalRequestOptions(method='post', url='/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_GIVEN...
           │    │          │    │       └ <class 'openai.types.completion.Completion'>
           │    │          │    └ <function SyncAPIClient.request at 0x7f8e90c404c0>
           │    │          └ <openai.OpenAI object at 0x7f8dbbd6e3b0>
           │    └ ~ResponseT
           └ <function cast at 0x7f8ed3f37a30>
  File "/usr/local/lib/python3.10/site-packages/openai/_base_client.py", line 889, in request
    return self._request(
           │    └ <function SyncAPIClient._request at 0x7f8e90c40550>
           └ <openai.OpenAI object at 0x7f8dbbd6e3b0>
  File "/usr/local/lib/python3.10/site-packages/openai/_base_client.py", line 980, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x7f8e90c22830>
          └ <openai.OpenAI object at 0x7f8dbbd6e3b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'This is a chat model and not supported in the v1/completions endpoint. Did you mean to use v1/chat/completions?', 'type': 'invalid_request_error', 'param': 'model', 'code': None}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 10
               └ <function _main at 0x7f8ed47a5510>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7f8ed49451b0>
           └ <SpawnProcess name='SpawnProcess-18' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f8ed4944820>
    └ <SpawnProcess name='SpawnProcess-18' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7f8ed49bc310>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-18' parent=1 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-18' parent=1 started>
    │    └ <function subprocess_started at 0x7f8ed3b7e5f0>
    └ <SpawnProcess name='SpawnProcess-18' parent=1 started>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7f8ed49beb00>>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
           │       │   │    └ <function Server.serve at 0x7f8ed3b7db40>
           │       │   └ <uvicorn.server.Server object at 0x7f8ed49beb00>
           │       └ <function run at 0x7f8ed3da67a0>
           └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>
  File "/usr/local/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f8ed3694350>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>
> File "/usr/local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 399, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ed4a4efe0>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbec53...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f8ed4723340>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ed4a4efe0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbec53...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
  File "/usr/local/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbec53...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8dca2aed70>
          └ <fastapi.applications.FastAPI object at 0x7f8ed4723340>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8dca29b2e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8dca2aee60>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8dca2aed70>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8dca29b2e0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │                            │    │    └ <starlette.requests.Request object at 0x7f8dbbec44f0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7f8dca295f90>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8dca2aee60>
          └ <function wrap_app_handling_exceptions at 0x7f8ea4b0d5a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f8dca29b7f0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          └ <fastapi.routing.APIRouter object at 0x7f8dca295f90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f8dca29b7f0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7f8dca295f90>>
          └ <fastapi.routing.APIRouter object at 0x7f8dca295f90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f8dca29b7f0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │     └ <function Route.handle at 0x7f8ea4b0e950>
          └ APIRoute(path='/chat/message', name='process_message', methods=['POST'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f8dca29b7f0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <function request_response.<locals>.app at 0x7f8dca29ab00>
          └ APIRoute(path='/chat/message', name='process_message', methods=['POST'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f8dca29b7f0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │                            │    └ <starlette.requests.Request object at 0x7f8dbbec4940>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7f8dca29a830>
          └ <function wrap_app_handling_exceptions at 0x7f8ea4b0d5a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f8dca29b250>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          └ <function request_response.<locals>.app.<locals>.app at 0x7f8dca29a830>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f8dbbec4940>
                     └ <function get_request_handler.<locals>.app at 0x7f8dca29aa70>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f8ea4b0f7f0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'user_prompt_request': UserPromptRequest(workflow='Check', mode='collection', collection_id='667843591624d2699fdc8ce2', coll...
                 │                 │         └ <function process_message at 0x7f8dcbcd1240>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x7f8dca295840>
                 └ <function run_in_threadpool at 0x7f8ea5428550>
  File "/usr/local/lib/python3.10/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function process_message at 0x7f8dcbcd1240>, user_prompt_request=UserPromptRequest(workflow='Check', mode=...
                 │     │         └ <function run_sync at 0x7f8ed39e9f30>
                 │     └ <module 'anyio.to_thread' from '/usr/local/lib/python3.10/site-packages/anyio/to_thread.py'>
                 └ <module 'anyio' from '/usr/local/lib/python3.10/site-packages/anyio/__init__.py'>
  File "/usr/local/lib/python3.10/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x7f8ed3bdb880>
  File "/usr/local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 2177, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=CustomException('Error while processing incoming message')>
  File "/usr/local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 859, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function process_message at 0x7f8dcbcd1240>, user_prompt_request=UserPromptRequest(workflow='Check', mode=...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x7f8dbbde0640>

  File "/app/app/routers/chat.py", line 364, in process_message
    raise CustomException(
          └ <class 'app.exceptions.custom_exception.CustomException'>

app.exceptions.custom_exception.CustomException: Error while processing incoming message
ERROR    2024-06-23 17:35:43.568 request id: app - uvicorn.protocols.http.httptools_impl:run_asgi - Exception in ASGI application

Traceback (most recent call last):

  File "/app/app/routers/chat.py", line 333, in process_message
    response = rag_pipeline.query(message, precision=PRECISION)
               │            │     │                  └ '5'
               │            │     └ "C'est quoi un AAE ?"
               │            └ <function CheckerRAGPipeline.query at 0x7f8ddde549d0>
               └ <app.ds.rag_pipeline.CheckerRAGPipeline object at 0x7f8dbbec5480>

  File "/app/app/ds/rag_pipeline.py", line 246, in query
    return query_engine.run(query_str=message)
           │            │             └ "C'est quoi un AAE ?"
           │            └ <function QueryPipeline.run at 0x7f8ddde13f40>
           └ QueryPipeline(partial_dict={}, callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, m...

  File "/usr/local/lib/python3.10/site-packages/llama_index/core/query_pipeline/query.py", line 321, in run
    outputs, _ = self._run(
                 │    └ <function QueryPipeline._run at 0x7f8ddde28820>
                 └ QueryPipeline(partial_dict={}, callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, m...
  File "/usr/local/lib/python3.10/site-packages/llama_index/core/query_pipeline/query.py", line 673, in _run
    result_outputs, intermediates = self._run_multi(
                                    │    └ <function QueryPipeline._run_multi at 0x7f8ddde28b80>
                                    └ QueryPipeline(partial_dict={}, callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, m...
  File "/usr/local/lib/python3.10/site-packages/llama_index/core/query_pipeline/query.py", line 876, in _run_multi
    output_dict = module.run_component(**module_input)
                  │      │               └ {'prompt': "You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces o...
                  │      └ <function QueryComponent.run_component at 0x7f8e9cf8c4c0>
                  └ LLMCompleteComponent(partial_dict={}, llm=OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object...
  File "/usr/local/lib/python3.10/site-packages/llama_index/core/base/query_pipeline/query.py", line 199, in run_component
    component_outputs = self._run_component(**kwargs)
                        │    │                └ {'prompt': "You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces o...
                        │    └ <function LLMCompleteComponent._run_component at 0x7f8e9d01feb0>
                        └ LLMCompleteComponent(partial_dict={}, llm=OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object...
  File "/usr/local/lib/python3.10/site-packages/llama_index/core/llms/llm.py", line 725, in _run_component
    response = self.llm.complete(prompt, formatted=True)
               │    │   │        └ "You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces of context.\...
               │    │   └ <FunctionWrapper at 0x7f8de062be20 for function at 0x7f8de068dbd0>
               │    └ OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, system_prompt=None, m...
               └ LLMCompleteComponent(partial_dict={}, llm=OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object...
  File "/usr/local/lib/python3.10/site-packages/llama_index/core/instrumentation/dispatcher.py", line 230, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {'formatted': True}
             │     └ ("You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces of context....
             └ <bound method OpenAILike.complete of OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0...
  File "/usr/local/lib/python3.10/site-packages/llama_index/llms/openai_like/base.py", line 88, in complete
    return super().complete(prompt, **kwargs)
                            │         └ {}
                            └ "You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces of context.\...
  File "/usr/local/lib/python3.10/site-packages/llama_index/core/instrumentation/dispatcher.py", line 230, in wrapper
    result = func(*args, **kwargs)
             │     │       └ {}
             │     └ ("You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces of context....
             └ <bound method OpenAI.complete of OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8...
  File "/usr/local/lib/python3.10/site-packages/llama_index/core/llms/callbacks.py", line 429, in wrapped_llm_predict
    f_return_val = f(_self, *args, **kwargs)
                   │ │       │       └ {}
                   │ │       └ ("You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces of context....
                   │ └ OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, system_prompt=None, m...
                   └ <function OpenAI.complete at 0x7f8e8bee7d90>
  File "/usr/local/lib/python3.10/site-packages/llama_index/llms/openai/base.py", line 332, in complete
    return complete_fn(prompt, **kwargs)
           │           │         └ {}
           │           └ "You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces of context.\...
           └ <bound method OpenAI._complete of OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f...
  File "/usr/local/lib/python3.10/site-packages/llama_index/llms/openai/base.py", line 96, in wrapper
    return retry(f)(self, *args, **kwargs)
           │     │  │      │       └ {}
           │     │  │      └ ("You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces of context....
           │     │  └ OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, system_prompt=None, m...
           │     └ <function OpenAI._complete at 0x7f8e8befc670>
           └ <function retry.<locals>.wrap at 0x7f8dbbd693f0>
  File "/usr/local/lib/python3.10/site-packages/tenacity/__init__.py", line 330, in wrapped_f
    return self(f, *args, **kw)
           │    │   │       └ {}
           │    │   └ (OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, system_prompt=None, ...
           │    └ <function OpenAI._complete at 0x7f8e8befc670>
           └ <Retrying object at 0x7f8dbbd6f310 (stop=<tenacity.stop.stop_any object at 0x7f8dbbd6fc10>, wait=<tenacity.wait.wait_random_e...
  File "/usr/local/lib/python3.10/site-packages/tenacity/__init__.py", line 467, in __call__
    do = self.iter(retry_state=retry_state)
         │    │                └ <RetryCallState 140246718539872: attempt #1; slept for 0.0; last result: failed (NotFoundError Error code: 404 - {'error': {'...
         │    └ <function BaseRetrying.iter at 0x7f8e90ebaf80>
         └ <Retrying object at 0x7f8dbbd6f310 (stop=<tenacity.stop.stop_any object at 0x7f8dbbd6fc10>, wait=<tenacity.wait.wait_random_e...
  File "/usr/local/lib/python3.10/site-packages/tenacity/__init__.py", line 368, in iter
    result = action(retry_state)
             │      └ <RetryCallState 140246718539872: attempt #1; slept for 0.0; last result: failed (NotFoundError Error code: 404 - {'error': {'...
             └ <function BaseRetrying._post_retry_check_actions.<locals>.<lambda> at 0x7f8dbbd76c20>
  File "/usr/local/lib/python3.10/site-packages/tenacity/__init__.py", line 390, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                 │   │  │       └ <function Future.result at 0x7f8ed4648040>
                                 │   │  └ <Future at 0x7f8dbaa87730 state=finished raised NotFoundError>
                                 │   └ <RetryCallState 140246718539872: attempt #1; slept for 0.0; last result: failed (NotFoundError Error code: 404 - {'error': {'...
                                 └ <RetryCallState 140246718539872: attempt #1; slept for 0.0; last result: failed (NotFoundError Error code: 404 - {'error': {'...
  File "/usr/local/lib/python3.10/concurrent/futures/_base.py", line 451, in result
    return self.__get_result()
           └ None
  File "/usr/local/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
    raise self._exception
          └ None
  File "/usr/local/lib/python3.10/site-packages/tenacity/__init__.py", line 470, in __call__
    result = fn(*args, **kwargs)
             │   │       └ {}
             │   └ (OpenAILike(callback_manager=<llama_index.core.callbacks.base.CallbackManager object at 0x7f8dbbd6d150>, system_prompt=None, ...
             └ <function OpenAI._complete at 0x7f8e8befc670>
  File "/usr/local/lib/python3.10/site-packages/llama_index/llms/openai/base.py", line 514, in _complete
    response = client.completions.create(
               │      │           └ <function Completions.create at 0x7f8e90a1fd90>
               │      └ <openai.resources.completions.Completions object at 0x7f8dca23f460>
               └ <openai.OpenAI object at 0x7f8dbbd6e3b0>
  File "/usr/local/lib/python3.10/site-packages/openai/_utils/_utils.py", line 275, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'prompt': "You are a helpful code assistant. Your task is to reformulate the question in French using the following pieces o...
           │     └ (<openai.resources.completions.Completions object at 0x7f8dca23f460>,)
           └ <function Completions.create at 0x7f8e90a1fd00>
  File "/usr/local/lib/python3.10/site-packages/openai/resources/completions.py", line 506, in create
    return self._post(
           │    └ <bound method SyncAPIClient.post of <openai.OpenAI object at 0x7f8dbbd6e3b0>>
           └ <openai.resources.completions.Completions object at 0x7f8dca23f460>
  File "/usr/local/lib/python3.10/site-packages/openai/_base_client.py", line 1200, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
           │    │          │    │       │        │            │                  └ openai.Stream[openai.types.completion.Completion]
           │    │          │    │       │        │            └ False
           │    │          │    │       │        └ FinalRequestOptions(method='post', url='/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_GIVEN...
           │    │          │    │       └ <class 'openai.types.completion.Completion'>
           │    │          │    └ <function SyncAPIClient.request at 0x7f8e90c404c0>
           │    │          └ <openai.OpenAI object at 0x7f8dbbd6e3b0>
           │    └ ~ResponseT
           └ <function cast at 0x7f8ed3f37a30>
  File "/usr/local/lib/python3.10/site-packages/openai/_base_client.py", line 889, in request
    return self._request(
           │    └ <function SyncAPIClient._request at 0x7f8e90c40550>
           └ <openai.OpenAI object at 0x7f8dbbd6e3b0>
  File "/usr/local/lib/python3.10/site-packages/openai/_base_client.py", line 980, in _request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x7f8e90c22830>
          └ <openai.OpenAI object at 0x7f8dbbd6e3b0>

openai.NotFoundError: Error code: 404 - {'error': {'message': 'This is a chat model and not supported in the v1/completions endpoint. Did you mean to use v1/chat/completions?', 'type': 'invalid_request_error', 'param': 'model', 'code': None}}


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 10
               └ <function _main at 0x7f8ed47a5510>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7f8ed49451b0>
           └ <SpawnProcess name='SpawnProcess-18' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f8ed4944820>
    └ <SpawnProcess name='SpawnProcess-18' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7f8ed49bc310>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-18' parent=1 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-18' parent=1 started>
    │    └ <function subprocess_started at 0x7f8ed3b7e5f0>
    └ <SpawnProcess name='SpawnProcess-18' parent=1 started>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7f8ed49beb00>>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
           │       │   │    └ <function Server.serve at 0x7f8ed3b7db40>
           │       │   └ <uvicorn.server.Server object at 0x7f8ed49beb00>
           │       └ <function run at 0x7f8ed3da67a0>
           └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>
  File "/usr/local/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f8ed3694350>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>
> File "/usr/local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 399, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ed4a4efe0>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbec53...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f8ed4723340>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f8ed4a4efe0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbec53...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
  File "/usr/local/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbec53...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8dca2aed70>
          └ <fastapi.applications.FastAPI object at 0x7f8ed4723340>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8dca29b2e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8dca2aee60>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f8dca2aed70>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f8dca29b2e0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │                            │    │    └ <starlette.requests.Request object at 0x7f8dbbec44f0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7f8dca295f90>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f8dca2aee60>
          └ <function wrap_app_handling_exceptions at 0x7f8ea4b0d5a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f8dca29b7f0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          └ <fastapi.routing.APIRouter object at 0x7f8dca295f90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f8dca29b7f0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7f8dca295f90>>
          └ <fastapi.routing.APIRouter object at 0x7f8dca295f90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f8dca29b7f0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │     └ <function Route.handle at 0x7f8ea4b0e950>
          └ APIRoute(path='/chat/message', name='process_message', methods=['POST'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f8dca29b7f0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <function request_response.<locals>.app at 0x7f8dca29ab00>
          └ APIRoute(path='/chat/message', name='process_message', methods=['POST'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f8dca29b7f0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │                            │    └ <starlette.requests.Request object at 0x7f8dbbec4940>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7f8dca29a830>
          └ <function wrap_app_handling_exceptions at 0x7f8ea4b0d5a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f8dca29b250>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f8dbbe...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          └ <function request_response.<locals>.app.<locals>.app at 0x7f8dca29a830>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f8dbbec4940>
                     └ <function get_request_handler.<locals>.app at 0x7f8dca29aa70>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f8ea4b0f7f0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'user_prompt_request': UserPromptRequest(workflow='Check', mode='collection', collection_id='667843591624d2699fdc8ce2', coll...
                 │                 │         └ <function process_message at 0x7f8dcbcd1240>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x7f8dca295840>
                 └ <function run_in_threadpool at 0x7f8ea5428550>
  File "/usr/local/lib/python3.10/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function process_message at 0x7f8dcbcd1240>, user_prompt_request=UserPromptRequest(workflow='Check', mode=...
                 │     │         └ <function run_sync at 0x7f8ed39e9f30>
                 │     └ <module 'anyio.to_thread' from '/usr/local/lib/python3.10/site-packages/anyio/to_thread.py'>
                 └ <module 'anyio' from '/usr/local/lib/python3.10/site-packages/anyio/__init__.py'>
  File "/usr/local/lib/python3.10/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x7f8ed3bdb880>
  File "/usr/local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 2177, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=CustomException('Error while processing incoming message')>
  File "/usr/local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 859, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function process_message at 0x7f8dcbcd1240>, user_prompt_request=UserPromptRequest(workflow='Check', mode=...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x7f8dbbde0640>

  File "/app/app/routers/chat.py", line 364, in process_message
    raise CustomException(
          └ <class 'app.exceptions.custom_exception.CustomException'>

app.exceptions.custom_exception.CustomException: Error while processing incoming message
INFO     2024-06-23 17:36:55.286 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:36:55.287 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:36:55.389 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:36:55.390 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:37:11.406 request id: app - uvicorn.server:_serve - Started server process [507]
INFO     2024-06-23 17:37:11.406 request id: app - uvicorn.server:_serve - Started server process [507]
INFO     2024-06-23 17:37:11.407 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:37:11.407 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:37:11.468 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 17:37:11.658 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 17:37:11.714 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 17:37:11.717 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:37:11.718 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:37:11.733 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:49136 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 17:37:11.740 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:45868 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 17:37:11.747 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:49124 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 17:37:11.768 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:45884 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 17:37:20.340 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:47806 - "POST /api/chat/message HTTP/1.0" 500
ERROR    2024-06-23 17:37:20.341 request id: app - uvicorn.protocols.http.httptools_impl:run_asgi - Exception in ASGI application

Traceback (most recent call last):

  File "/app/app/routers/chat.py", line 315, in process_message
    rag_pipeline = rag.get_rag_pipeline(
                   │   └ <function get_rag_pipeline at 0x7faa25a42a70>
                   └ <module 'app.ds.rag_pipeline' from '/app/app/ds/rag_pipeline.py'>

  File "/app/app/ds/rag_pipeline.py", line 44, in get_rag_pipeline
    return CheckerRAGPipeline(
           └ <class 'app.ds.rag_pipeline.CheckerRAGPipeline'>

  File "/app/app/ds/rag_pipeline.py", line 189, in __init__
    self.llm_model = OpenAI(model=llm_model_name,timeout=60,temperature=self.params["temperature"],top_p=self.params["top_p"])
    │                │            │                                     │                                └ <app.ds.rag_pipeline.CheckerRAGPipeline object at 0x7fa9507bd8a0>
    │                │            │                                     └ <app.ds.rag_pipeline.CheckerRAGPipeline object at 0x7fa9507bd8a0>
    │                │            └ 'gpt-3.5-turbo'
    │                └ <class 'llama_index.llms.openai.base.OpenAI'>
    └ <app.ds.rag_pipeline.CheckerRAGPipeline object at 0x7fa9507bd8a0>

AttributeError: 'CheckerRAGPipeline' object has no attribute 'params'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 10
               └ <function _main at 0x7faa5cf89510>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7faa5d1291b0>
           └ <SpawnProcess name='SpawnProcess-19' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7faa5d128820>
    └ <SpawnProcess name='SpawnProcess-19' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7faa5d1a0310>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-19' parent=1 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-19' parent=1 started>
    │    └ <function subprocess_started at 0x7faa5c3625f0>
    └ <SpawnProcess name='SpawnProcess-19' parent=1 started>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7faa5d1a2b00>>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
           │       │   │    └ <function Server.serve at 0x7faa5c361b40>
           │       │   └ <uvicorn.server.Server object at 0x7faa5d1a2b00>
           │       └ <function run at 0x7faa5c58a7a0>
           └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>
  File "/usr/local/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7faa5be78350>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>
> File "/usr/local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 399, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7faa5d232fe0>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507be3...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7faa5cf07340>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7faa5d232fe0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507be3...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
  File "/usr/local/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507be3...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa952aaada0>
          └ <fastapi.applications.FastAPI object at 0x7faa5cf07340>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa952a932e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa952aaae90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa952aaada0>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa952a932e0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │                            │    │    └ <starlette.requests.Request object at 0x7fa9507be350>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7fa952a8df90>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa952aaae90>
          └ <function wrap_app_handling_exceptions at 0x7faa2d2ed5a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa952a93d90>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          └ <fastapi.routing.APIRouter object at 0x7fa952a8df90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa952a93d90>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7fa952a8df90>>
          └ <fastapi.routing.APIRouter object at 0x7fa952a8df90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa952a93d90>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │     └ <function Route.handle at 0x7faa2d2ee950>
          └ APIRoute(path='/chat/message', name='process_message', methods=['POST'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa952a93d90>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <function request_response.<locals>.app at 0x7fa952a92b00>
          └ APIRoute(path='/chat/message', name='process_message', methods=['POST'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa952a93d90>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │                            │    └ <starlette.requests.Request object at 0x7fa9507bca90>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7fa952a93250>
          └ <function wrap_app_handling_exceptions at 0x7faa2d2ed5a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa952a928c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          └ <function request_response.<locals>.app.<locals>.app at 0x7fa952a93250>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fa9507bca90>
                     └ <function get_request_handler.<locals>.app at 0x7fa952a92a70>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7faa2d2ef7f0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'user_prompt_request': UserPromptRequest(workflow='Check', mode='collection', collection_id='667843591624d2699fdc8ce2', coll...
                 │                 │         └ <function process_message at 0x7fa9544c9240>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x7fa952a8d870>
                 └ <function run_in_threadpool at 0x7faa2dc0c550>
  File "/usr/local/lib/python3.10/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function process_message at 0x7fa9544c9240>, user_prompt_request=UserPromptRequest(workflow='Check', mode=...
                 │     │         └ <function run_sync at 0x7faa5c1cdf30>
                 │     └ <module 'anyio.to_thread' from '/usr/local/lib/python3.10/site-packages/anyio/to_thread.py'>
                 └ <module 'anyio' from '/usr/local/lib/python3.10/site-packages/anyio/__init__.py'>
  File "/usr/local/lib/python3.10/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x7faa5c3bf880>
  File "/usr/local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 2177, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=CustomException('Error while processing incoming message')>
  File "/usr/local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 859, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function process_message at 0x7fa9544c9240>, user_prompt_request=UserPromptRequest(workflow='Check', mode=...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x7fa9506ad880>

  File "/app/app/routers/chat.py", line 364, in process_message
    raise CustomException(
          └ <class 'app.exceptions.custom_exception.CustomException'>

app.exceptions.custom_exception.CustomException: Error while processing incoming message
ERROR    2024-06-23 17:37:20.399 request id: app - uvicorn.protocols.http.httptools_impl:run_asgi - Exception in ASGI application

Traceback (most recent call last):

  File "/app/app/routers/chat.py", line 315, in process_message
    rag_pipeline = rag.get_rag_pipeline(
                   │   └ <function get_rag_pipeline at 0x7faa25a42a70>
                   └ <module 'app.ds.rag_pipeline' from '/app/app/ds/rag_pipeline.py'>

  File "/app/app/ds/rag_pipeline.py", line 44, in get_rag_pipeline
    return CheckerRAGPipeline(
           └ <class 'app.ds.rag_pipeline.CheckerRAGPipeline'>

  File "/app/app/ds/rag_pipeline.py", line 189, in __init__
    self.llm_model = OpenAI(model=llm_model_name,timeout=60,temperature=self.params["temperature"],top_p=self.params["top_p"])
    │                │            │                                     │                                └ <app.ds.rag_pipeline.CheckerRAGPipeline object at 0x7fa9507bd8a0>
    │                │            │                                     └ <app.ds.rag_pipeline.CheckerRAGPipeline object at 0x7fa9507bd8a0>
    │                │            └ 'gpt-3.5-turbo'
    │                └ <class 'llama_index.llms.openai.base.OpenAI'>
    └ <app.ds.rag_pipeline.CheckerRAGPipeline object at 0x7fa9507bd8a0>

AttributeError: 'CheckerRAGPipeline' object has no attribute 'params'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 10
               └ <function _main at 0x7faa5cf89510>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7faa5d1291b0>
           └ <SpawnProcess name='SpawnProcess-19' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7faa5d128820>
    └ <SpawnProcess name='SpawnProcess-19' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7faa5d1a0310>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-19' parent=1 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-19' parent=1 started>
    │    └ <function subprocess_started at 0x7faa5c3625f0>
    └ <SpawnProcess name='SpawnProcess-19' parent=1 started>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7faa5d1a2b00>>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
           │       │   │    └ <function Server.serve at 0x7faa5c361b40>
           │       │   └ <uvicorn.server.Server object at 0x7faa5d1a2b00>
           │       └ <function run at 0x7faa5c58a7a0>
           └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>
  File "/usr/local/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7faa5be78350>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>
> File "/usr/local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 399, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7faa5d232fe0>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507be3...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7faa5cf07340>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7faa5d232fe0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507be3...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
  File "/usr/local/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507be3...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa952aaada0>
          └ <fastapi.applications.FastAPI object at 0x7faa5cf07340>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa952a932e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa952aaae90>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7fa952aaada0>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7fa952a932e0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │                            │    │    └ <starlette.requests.Request object at 0x7fa9507be350>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7fa952a8df90>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7fa952aaae90>
          └ <function wrap_app_handling_exceptions at 0x7faa2d2ed5a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa952a93d90>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          └ <fastapi.routing.APIRouter object at 0x7fa952a8df90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa952a93d90>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7fa952a8df90>>
          └ <fastapi.routing.APIRouter object at 0x7fa952a8df90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa952a93d90>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │     └ <function Route.handle at 0x7faa2d2ee950>
          └ APIRoute(path='/chat/message', name='process_message', methods=['POST'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa952a93d90>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │    └ <function request_response.<locals>.app at 0x7fa952a92b00>
          └ APIRoute(path='/chat/message', name='process_message', methods=['POST'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa952a93d90>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          │                            │    └ <starlette.requests.Request object at 0x7fa9507bca90>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7fa952a93250>
          └ <function wrap_app_handling_exceptions at 0x7faa2d2ed5a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7fa952a928c0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7fa9507...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.25.0.7', 8100), 'c...
          └ <function request_response.<locals>.app.<locals>.app at 0x7fa952a93250>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7fa9507bca90>
                     └ <function get_request_handler.<locals>.app at 0x7fa952a92a70>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7faa2d2ef7f0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 193, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
                 │                 │         │       └ {'user_prompt_request': UserPromptRequest(workflow='Check', mode='collection', collection_id='667843591624d2699fdc8ce2', coll...
                 │                 │         └ <function process_message at 0x7fa9544c9240>
                 │                 └ <fastapi.dependencies.models.Dependant object at 0x7fa952a8d870>
                 └ <function run_in_threadpool at 0x7faa2dc0c550>
  File "/usr/local/lib/python3.10/site-packages/starlette/concurrency.py", line 42, in run_in_threadpool
    return await anyio.to_thread.run_sync(func, *args)
                 │     │         │        │      └ ()
                 │     │         │        └ functools.partial(<function process_message at 0x7fa9544c9240>, user_prompt_request=UserPromptRequest(workflow='Check', mode=...
                 │     │         └ <function run_sync at 0x7faa5c1cdf30>
                 │     └ <module 'anyio.to_thread' from '/usr/local/lib/python3.10/site-packages/anyio/to_thread.py'>
                 └ <module 'anyio' from '/usr/local/lib/python3.10/site-packages/anyio/__init__.py'>
  File "/usr/local/lib/python3.10/site-packages/anyio/to_thread.py", line 56, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
                 └ <function get_async_backend at 0x7faa5c3bf880>
  File "/usr/local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 2177, in run_sync_in_worker_thread
    return await future
                 └ <Future finished exception=CustomException('Error while processing incoming message')>
  File "/usr/local/lib/python3.10/site-packages/anyio/_backends/_asyncio.py", line 859, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function process_message at 0x7fa9544c9240>, user_prompt_request=UserPromptRequest(workflow='Check', mode=...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x7fa9506ad880>

  File "/app/app/routers/chat.py", line 364, in process_message
    raise CustomException(
          └ <class 'app.exceptions.custom_exception.CustomException'>

app.exceptions.custom_exception.CustomException: Error while processing incoming message
INFO     2024-06-23 17:37:58.872 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:37:58.873 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 17:37:58.975 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:37:58.977 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 17:38:14.499 request id: app - uvicorn.server:_serve - Started server process [537]
INFO     2024-06-23 17:38:14.500 request id: app - uvicorn.server:_serve - Started server process [537]
INFO     2024-06-23 17:38:14.501 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:38:14.501 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 17:38:14.560 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 17:38:14.744 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 17:38:14.805 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 17:38:14.809 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:38:14.811 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 17:38:15.529 request id: app - httpx._client:_send_single_request - HTTP Request: GET http://qdrant:6333/collections/qdr/exists "HTTP/1.1 200 OK"
INFO     2024-06-23 17:38:15.912 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO     2024-06-23 17:38:15.932 request id: app - httpx._client:_send_single_request - HTTP Request: POST http://qdrant:6333/collections/qdr/points/search "HTTP/1.1 200 OK"
INFO     2024-06-23 17:38:16.829 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO     2024-06-23 17:38:16.901 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.25.0.6:46782 - "POST /api/chat/message HTTP/1.0" 200
INFO     2024-06-23 17:38:17.565 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO     2024-06-23 18:30:28.223 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 18:30:28.228 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 18:30:28.331 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 18:30:28.332 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 19:03:03.130 request id: app - uvicorn.server:_serve - Started server process [7]
INFO     2024-06-23 19:03:03.131 request id: app - uvicorn.server:_serve - Started server process [7]
INFO     2024-06-23 19:03:03.132 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 19:03:03.133 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 19:03:03.214 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 19:03:03.390 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 19:03:03.461 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 19:03:03.465 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 19:03:03.466 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 19:12:44.762 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 19:12:44.763 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 19:12:44.864 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 19:12:44.867 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 19:16:06.331 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 19:16:06.332 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 19:16:06.333 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 19:16:06.334 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 19:16:06.428 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 19:16:06.599 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 19:16:06.670 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 19:16:06.674 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 19:16:06.676 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 19:21:18.079 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 19:21:18.082 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 19:21:18.188 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 19:21:18.190 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 19:22:53.139 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 19:22:53.140 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 19:22:53.141 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 19:22:53.142 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 19:22:53.219 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 19:22:53.382 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 19:22:53.430 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 19:22:53.432 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 19:22:53.433 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 19:27:37.618 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 19:27:37.620 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 19:27:37.722 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 19:27:37.727 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 19:31:27.812 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 19:31:27.813 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 19:31:27.815 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 19:31:27.817 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 19:31:27.908 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 19:31:28.130 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 19:31:28.191 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 19:31:28.195 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 19:31:28.197 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 19:33:05.436 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 19:33:05.442 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 19:33:05.548 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 19:33:05.550 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 19:34:27.223 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 19:34:27.224 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 19:34:27.225 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 19:34:27.226 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 19:34:27.332 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 19:34:27.529 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 19:34:27.605 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 19:34:27.608 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 19:34:27.609 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:04:59.180 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:04:59.185 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:04:59.341 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:04:59.362 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:12:16.803 request id: app - uvicorn.server:_serve - Started server process [7]
INFO     2024-06-23 20:12:16.804 request id: app - uvicorn.server:_serve - Started server process [7]
INFO     2024-06-23 20:12:16.805 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:12:16.807 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:12:16.904 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 20:12:17.125 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 20:12:17.185 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 20:12:17.188 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:12:17.189 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:13:32.896 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:57342 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:13:32.924 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:57348 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:13:42.958 request id: app - httpx._client:_send_single_request - HTTP Request: POST http://qdrant:6333/collections/qdr/points/delete?wait=true "HTTP/1.1 404 Not Found"
INFO     2024-06-23 20:13:42.994 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:44592 - "DELETE /api/collections/667843591624d2699fdc8ce2 HTTP/1.0" 500
ERROR    2024-06-23 20:13:42.996 request id: app - uvicorn.protocols.http.httptools_impl:run_asgi - Exception in ASGI application

Traceback (most recent call last):

  File "/app/app/routers/collections.py", line 608, in delete_collection
    await remove_qdrant_index_async(str(collection_id))
          │                             └ '667843591624d2699fdc8ce2'
          └ <function remove_qdrant_index_async at 0x7f113d4c4310>

  File "/app/app/routers/collections.py", line 570, in remove_qdrant_index_async
    await asyncio.to_thread(remove_qdrant_index, index)
          │       │         │                    └ '667843591624d2699fdc8ce2'
          │       │         └ <function remove_qdrant_index at 0x7f113d5d4820>
          │       └ <function to_thread at 0x7f12456793f0>
          └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>

  File "/usr/local/lib/python3.10/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
                 │    │                     └ functools.partial(<built-in method run of _contextvars.Context object at 0x7f113d432280>, <function remove_qdrant_index at 0x...
                 │    └ <method 'run_in_executor' of 'uvloop.loop.Loop' objects>
                 └ <uvloop.Loop running=True closed=False debug=False>
  File "/usr/local/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/app/app/utils/qdrant.py", line 63, in remove_qdrant_index
    qdrant_client.delete(
    │             └ <function QdrantClient.delete at 0x7f114ffcf0a0>
    └ <qdrant_client.qdrant_client.QdrantClient object at 0x7f114f82ea70>

  File "/usr/local/lib/python3.10/site-packages/qdrant_client/qdrant_client.py", line 1201, in delete
    return self._client.delete(
           │    │       └ <function QdrantRemote.delete at 0x7f114ffcc9d0>
           │    └ <qdrant_client.qdrant_remote.QdrantRemote object at 0x7f114f82e9e0>
           └ <qdrant_client.qdrant_client.QdrantClient object at 0x7f114f82ea70>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/qdrant_remote.py", line 1700, in delete
    result: Optional[types.UpdateResult] = self.openapi_client.points_api.delete_points(
            │        │     │               │    │              │          └ <function SyncPointsApi.delete_points at 0x7f1150adeb90>
            │        │     │               │    │              └ <qdrant_client.http.api.points_api.SyncPointsApi object at 0x7f114f82f0a0>
            │        │     │               │    └ <qdrant_client.http.api_client.SyncApis object at 0x7f114f82ead0>
            │        │     │               └ <qdrant_client.qdrant_remote.QdrantRemote object at 0x7f114f82e9e0>
            │        │     └ <class 'qdrant_client.http.models.models.UpdateResult'>
            │        └ <module 'qdrant_client.conversions.common_types' from '/usr/local/lib/python3.10/site-packages/qdrant_client/conversions/comm...
            └ typing.Optional
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api/points_api.py", line 1173, in delete_points
    return self._build_for_delete_points(
           │    └ <function _PointsApi._build_for_delete_points at 0x7f1150add3f0>
           └ <qdrant_client.http.api.points_api.SyncPointsApi object at 0x7f114f82f0a0>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api/points_api.py", line 206, in _build_for_delete_points
    return self.api_client.request(
           │    │          └ <function ApiClient.request at 0x7f1150aee830>
           │    └ <qdrant_client.http.api_client.ApiClient object at 0x7f114f82eb00>
           └ <qdrant_client.http.api.points_api.SyncPointsApi object at 0x7f114f82f0a0>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api_client.py", line 76, in request
    return self.send(request, type_)
           │    │    │        └ <class 'qdrant_client.http.models.models.InlineResponse2007'>
           │    │    └ <Request('POST', 'http://qdrant:6333/collections/qdr/points/delete?wait=true')>
           │    └ <function ApiClient.send at 0x7f1150aee950>
           └ <qdrant_client.http.api_client.ApiClient object at 0x7f114f82eb00>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api_client.py", line 99, in send
    raise UnexpectedResponse.for_response(response)
          │                  │            └ <Response [404 Not Found]>
          │                  └ <staticmethod(<function UnexpectedResponse.for_response at 0x7f1150aee4d0>)>
          └ <class 'qdrant_client.http.exceptions.UnexpectedResponse'>

qdrant_client.http.exceptions.UnexpectedResponse: Unexpected Response: 404 (Not Found)
Raw response content:
b'{"status":{"error":"Not found: Collection `qdr` doesn\'t exist!"},"time":0.000040063}'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/app/app/routers/collections.py", line 610, in delete_collection
    raise HTTPException(
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 400: Error while deleting the collection 667843591624d2699fdc8ce2 files from qdrant


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x7f1246091510>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7f12462311b0>
           └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f1246230820>
    └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7f12461c5f90>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
    │    └ <function subprocess_started at 0x7f12454665f0>
    └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7f124565d210>>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
           │       │   │    └ <function Server.serve at 0x7f1245465b40>
           │       │   └ <uvicorn.server.Server object at 0x7f124565d210>
           │       └ <function run at 0x7f12458de7a0>
           └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>
  File "/usr/local/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f1244f7c350>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>
> File "/usr/local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 399, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f12457166e0>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398ca5...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f12461bc520>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f12457166e0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398ca5...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
  File "/usr/local/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398ca5...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f113bbbad70>
          └ <fastapi.applications.FastAPI object at 0x7f12461bc520>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f113bb9f2e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f113bbbae60>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f113bbbad70>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f113bb9f2e0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │                            │    │    └ <starlette.requests.Request object at 0x7f11398c9e70>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7f113bb99f90>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f113bbbae60>
          └ <function wrap_app_handling_exceptions at 0x7f12164015a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113bb9f490>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          └ <fastapi.routing.APIRouter object at 0x7f113bb99f90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113bb9f490>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7f113bb99f90>>
          └ <fastapi.routing.APIRouter object at 0x7f113bb99f90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113bb9f490>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │     └ <function Route.handle at 0x7f1216402950>
          └ APIRoute(path='/collections/{collection_id}', name='delete_collection', methods=['DELETE'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113bb9f490>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <function request_response.<locals>.app at 0x7f113bb9f370>
          └ APIRoute(path='/collections/{collection_id}', name='delete_collection', methods=['DELETE'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113bb9f490>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │                            │    └ <starlette.requests.Request object at 0x7f11398ca3e0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7f113bb9fd90>
          └ <function wrap_app_handling_exceptions at 0x7f12164015a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113bb9f250>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          └ <function request_response.<locals>.app.<locals>.app at 0x7f113bb9fd90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f11398ca3e0>
                     └ <function get_request_handler.<locals>.app at 0x7f113bb9f400>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f12164037f0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'collection_id': '667843591624d2699fdc8ce2'}
                 │         └ <function delete_collection at 0x7f113d4c4430>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f113bb7dde0>

  File "/app/app/routers/collections.py", line 629, in delete_collection
    raise CustomException(
          └ <class 'app.exceptions.custom_exception.CustomException'>

app.exceptions.custom_exception.CustomException: Error while deleting the collection 667843591624d2699fdc8ce2
ERROR    2024-06-23 20:13:43.079 request id: app - uvicorn.protocols.http.httptools_impl:run_asgi - Exception in ASGI application

Traceback (most recent call last):

  File "/app/app/routers/collections.py", line 608, in delete_collection
    await remove_qdrant_index_async(str(collection_id))
          │                             └ '667843591624d2699fdc8ce2'
          └ <function remove_qdrant_index_async at 0x7f113d4c4310>

  File "/app/app/routers/collections.py", line 570, in remove_qdrant_index_async
    await asyncio.to_thread(remove_qdrant_index, index)
          │       │         │                    └ '667843591624d2699fdc8ce2'
          │       │         └ <function remove_qdrant_index at 0x7f113d5d4820>
          │       └ <function to_thread at 0x7f12456793f0>
          └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>

  File "/usr/local/lib/python3.10/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
                 │    │                     └ functools.partial(<built-in method run of _contextvars.Context object at 0x7f113d432280>, <function remove_qdrant_index at 0x...
                 │    └ <method 'run_in_executor' of 'uvloop.loop.Loop' objects>
                 └ <uvloop.Loop running=True closed=False debug=False>
  File "/usr/local/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/app/app/utils/qdrant.py", line 63, in remove_qdrant_index
    qdrant_client.delete(
    │             └ <function QdrantClient.delete at 0x7f114ffcf0a0>
    └ <qdrant_client.qdrant_client.QdrantClient object at 0x7f114f82ea70>

  File "/usr/local/lib/python3.10/site-packages/qdrant_client/qdrant_client.py", line 1201, in delete
    return self._client.delete(
           │    │       └ <function QdrantRemote.delete at 0x7f114ffcc9d0>
           │    └ <qdrant_client.qdrant_remote.QdrantRemote object at 0x7f114f82e9e0>
           └ <qdrant_client.qdrant_client.QdrantClient object at 0x7f114f82ea70>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/qdrant_remote.py", line 1700, in delete
    result: Optional[types.UpdateResult] = self.openapi_client.points_api.delete_points(
            │        │     │               │    │              │          └ <function SyncPointsApi.delete_points at 0x7f1150adeb90>
            │        │     │               │    │              └ <qdrant_client.http.api.points_api.SyncPointsApi object at 0x7f114f82f0a0>
            │        │     │               │    └ <qdrant_client.http.api_client.SyncApis object at 0x7f114f82ead0>
            │        │     │               └ <qdrant_client.qdrant_remote.QdrantRemote object at 0x7f114f82e9e0>
            │        │     └ <class 'qdrant_client.http.models.models.UpdateResult'>
            │        └ <module 'qdrant_client.conversions.common_types' from '/usr/local/lib/python3.10/site-packages/qdrant_client/conversions/comm...
            └ typing.Optional
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api/points_api.py", line 1173, in delete_points
    return self._build_for_delete_points(
           │    └ <function _PointsApi._build_for_delete_points at 0x7f1150add3f0>
           └ <qdrant_client.http.api.points_api.SyncPointsApi object at 0x7f114f82f0a0>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api/points_api.py", line 206, in _build_for_delete_points
    return self.api_client.request(
           │    │          └ <function ApiClient.request at 0x7f1150aee830>
           │    └ <qdrant_client.http.api_client.ApiClient object at 0x7f114f82eb00>
           └ <qdrant_client.http.api.points_api.SyncPointsApi object at 0x7f114f82f0a0>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api_client.py", line 76, in request
    return self.send(request, type_)
           │    │    │        └ <class 'qdrant_client.http.models.models.InlineResponse2007'>
           │    │    └ <Request('POST', 'http://qdrant:6333/collections/qdr/points/delete?wait=true')>
           │    └ <function ApiClient.send at 0x7f1150aee950>
           └ <qdrant_client.http.api_client.ApiClient object at 0x7f114f82eb00>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api_client.py", line 99, in send
    raise UnexpectedResponse.for_response(response)
          │                  │            └ <Response [404 Not Found]>
          │                  └ <staticmethod(<function UnexpectedResponse.for_response at 0x7f1150aee4d0>)>
          └ <class 'qdrant_client.http.exceptions.UnexpectedResponse'>

qdrant_client.http.exceptions.UnexpectedResponse: Unexpected Response: 404 (Not Found)
Raw response content:
b'{"status":{"error":"Not found: Collection `qdr` doesn\'t exist!"},"time":0.000040063}'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/app/app/routers/collections.py", line 610, in delete_collection
    raise HTTPException(
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 400: Error while deleting the collection 667843591624d2699fdc8ce2 files from qdrant


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x7f1246091510>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7f12462311b0>
           └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f1246230820>
    └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7f12461c5f90>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
    │    └ <function subprocess_started at 0x7f12454665f0>
    └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7f124565d210>>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
           │       │   │    └ <function Server.serve at 0x7f1245465b40>
           │       │   └ <uvicorn.server.Server object at 0x7f124565d210>
           │       └ <function run at 0x7f12458de7a0>
           └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>
  File "/usr/local/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f1244f7c350>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>
> File "/usr/local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 399, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f12457166e0>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398ca5...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f12461bc520>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f12457166e0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398ca5...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
  File "/usr/local/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398ca5...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f113bbbad70>
          └ <fastapi.applications.FastAPI object at 0x7f12461bc520>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f113bb9f2e0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f113bbbae60>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f113bbbad70>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f113bb9f2e0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │                            │    │    └ <starlette.requests.Request object at 0x7f11398c9e70>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7f113bb99f90>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f113bbbae60>
          └ <function wrap_app_handling_exceptions at 0x7f12164015a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113bb9f490>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          └ <fastapi.routing.APIRouter object at 0x7f113bb99f90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113bb9f490>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7f113bb99f90>>
          └ <fastapi.routing.APIRouter object at 0x7f113bb99f90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113bb9f490>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │     └ <function Route.handle at 0x7f1216402950>
          └ APIRoute(path='/collections/{collection_id}', name='delete_collection', methods=['DELETE'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113bb9f490>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <function request_response.<locals>.app at 0x7f113bb9f370>
          └ APIRoute(path='/collections/{collection_id}', name='delete_collection', methods=['DELETE'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113bb9f490>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │                            │    └ <starlette.requests.Request object at 0x7f11398ca3e0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7f113bb9fd90>
          └ <function wrap_app_handling_exceptions at 0x7f12164015a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113bb9f250>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          └ <function request_response.<locals>.app.<locals>.app at 0x7f113bb9fd90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f11398ca3e0>
                     └ <function get_request_handler.<locals>.app at 0x7f113bb9f400>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f12164037f0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'collection_id': '667843591624d2699fdc8ce2'}
                 │         └ <function delete_collection at 0x7f113d4c4430>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f113bb7dde0>

  File "/app/app/routers/collections.py", line 629, in delete_collection
    raise CustomException(
          └ <class 'app.exceptions.custom_exception.CustomException'>

app.exceptions.custom_exception.CustomException: Error while deleting the collection 667843591624d2699fdc8ce2
INFO     2024-06-23 20:13:43.224 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:44604 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:13:48.306 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:44628 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:13:48.328 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:44632 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:14:13.501 request id: app - httpx._client:_send_single_request - HTTP Request: POST http://qdrant:6333/collections/qdr/points/delete?wait=true "HTTP/1.1 404 Not Found"
INFO     2024-06-23 20:14:13.516 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:56830 - "DELETE /api/collections/667843591624d2699fdc8ce2 HTTP/1.0" 500
ERROR    2024-06-23 20:14:13.517 request id: app - uvicorn.protocols.http.httptools_impl:run_asgi - Exception in ASGI application

Traceback (most recent call last):

  File "/app/app/routers/collections.py", line 608, in delete_collection
    await remove_qdrant_index_async(str(collection_id))
          │                             └ '667843591624d2699fdc8ce2'
          └ <function remove_qdrant_index_async at 0x7f113d4c4310>

  File "/app/app/routers/collections.py", line 570, in remove_qdrant_index_async
    await asyncio.to_thread(remove_qdrant_index, index)
          │       │         │                    └ '667843591624d2699fdc8ce2'
          │       │         └ <function remove_qdrant_index at 0x7f113d5d4820>
          │       └ <function to_thread at 0x7f12456793f0>
          └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>

  File "/usr/local/lib/python3.10/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
                 │    │                     └ functools.partial(<built-in method run of _contextvars.Context object at 0x7f11397e1600>, <function remove_qdrant_index at 0x...
                 │    └ <method 'run_in_executor' of 'uvloop.loop.Loop' objects>
                 └ <uvloop.Loop running=True closed=False debug=False>
  File "/usr/local/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/app/app/utils/qdrant.py", line 63, in remove_qdrant_index
    qdrant_client.delete(
    │             └ <function QdrantClient.delete at 0x7f114ffcf0a0>
    └ <qdrant_client.qdrant_client.QdrantClient object at 0x7f114f82ea70>

  File "/usr/local/lib/python3.10/site-packages/qdrant_client/qdrant_client.py", line 1201, in delete
    return self._client.delete(
           │    │       └ <function QdrantRemote.delete at 0x7f114ffcc9d0>
           │    └ <qdrant_client.qdrant_remote.QdrantRemote object at 0x7f114f82e9e0>
           └ <qdrant_client.qdrant_client.QdrantClient object at 0x7f114f82ea70>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/qdrant_remote.py", line 1700, in delete
    result: Optional[types.UpdateResult] = self.openapi_client.points_api.delete_points(
            │        │     │               │    │              │          └ <function SyncPointsApi.delete_points at 0x7f1150adeb90>
            │        │     │               │    │              └ <qdrant_client.http.api.points_api.SyncPointsApi object at 0x7f114f82f0a0>
            │        │     │               │    └ <qdrant_client.http.api_client.SyncApis object at 0x7f114f82ead0>
            │        │     │               └ <qdrant_client.qdrant_remote.QdrantRemote object at 0x7f114f82e9e0>
            │        │     └ <class 'qdrant_client.http.models.models.UpdateResult'>
            │        └ <module 'qdrant_client.conversions.common_types' from '/usr/local/lib/python3.10/site-packages/qdrant_client/conversions/comm...
            └ typing.Optional
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api/points_api.py", line 1173, in delete_points
    return self._build_for_delete_points(
           │    └ <function _PointsApi._build_for_delete_points at 0x7f1150add3f0>
           └ <qdrant_client.http.api.points_api.SyncPointsApi object at 0x7f114f82f0a0>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api/points_api.py", line 206, in _build_for_delete_points
    return self.api_client.request(
           │    │          └ <function ApiClient.request at 0x7f1150aee830>
           │    └ <qdrant_client.http.api_client.ApiClient object at 0x7f114f82eb00>
           └ <qdrant_client.http.api.points_api.SyncPointsApi object at 0x7f114f82f0a0>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api_client.py", line 76, in request
    return self.send(request, type_)
           │    │    │        └ <class 'qdrant_client.http.models.models.InlineResponse2007'>
           │    │    └ <Request('POST', 'http://qdrant:6333/collections/qdr/points/delete?wait=true')>
           │    └ <function ApiClient.send at 0x7f1150aee950>
           └ <qdrant_client.http.api_client.ApiClient object at 0x7f114f82eb00>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api_client.py", line 99, in send
    raise UnexpectedResponse.for_response(response)
          │                  │            └ <Response [404 Not Found]>
          │                  └ <staticmethod(<function UnexpectedResponse.for_response at 0x7f1150aee4d0>)>
          └ <class 'qdrant_client.http.exceptions.UnexpectedResponse'>

qdrant_client.http.exceptions.UnexpectedResponse: Unexpected Response: 404 (Not Found)
Raw response content:
b'{"status":{"error":"Not found: Collection `qdr` doesn\'t exist!"},"time":0.00003869}'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/app/app/routers/collections.py", line 610, in delete_collection
    raise HTTPException(
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 400: Error while deleting the collection 667843591624d2699fdc8ce2 files from qdrant


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x7f1246091510>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7f12462311b0>
           └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f1246230820>
    └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7f12461c5f90>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
    │    └ <function subprocess_started at 0x7f12454665f0>
    └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7f124565d210>>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
           │       │   │    └ <function Server.serve at 0x7f1245465b40>
           │       │   └ <uvicorn.server.Server object at 0x7f124565d210>
           │       └ <function run at 0x7f12458de7a0>
           └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>
  File "/usr/local/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f1244f7c350>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>
> File "/usr/local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 399, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f12457166e0>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398cb5...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f12461bc520>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f12457166e0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398cb5...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
  File "/usr/local/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398cb5...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f113bbbad70>
          └ <fastapi.applications.FastAPI object at 0x7f12461bc520>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f113989cc10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f113bbbae60>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f113bbbad70>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f113989cc10>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │                            │    │    └ <starlette.requests.Request object at 0x7f11398cb760>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7f113bb99f90>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f113bbbae60>
          └ <function wrap_app_handling_exceptions at 0x7f12164015a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113989c8b0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          └ <fastapi.routing.APIRouter object at 0x7f113bb99f90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113989c8b0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7f113bb99f90>>
          └ <fastapi.routing.APIRouter object at 0x7f113bb99f90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113989c8b0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │     └ <function Route.handle at 0x7f1216402950>
          └ APIRoute(path='/collections/{collection_id}', name='delete_collection', methods=['DELETE'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113989c8b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <function request_response.<locals>.app at 0x7f113bb9f370>
          └ APIRoute(path='/collections/{collection_id}', name='delete_collection', methods=['DELETE'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113989c8b0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │                            │    └ <starlette.requests.Request object at 0x7f11398cb970>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7f113989cb80>
          └ <function wrap_app_handling_exceptions at 0x7f12164015a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113989caf0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          └ <function request_response.<locals>.app.<locals>.app at 0x7f113989cb80>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f11398cb970>
                     └ <function get_request_handler.<locals>.app at 0x7f113bb9f400>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f12164037f0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'collection_id': '667843591624d2699fdc8ce2'}
                 │         └ <function delete_collection at 0x7f113d4c4430>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f113bb7dde0>

  File "/app/app/routers/collections.py", line 629, in delete_collection
    raise CustomException(
          └ <class 'app.exceptions.custom_exception.CustomException'>

app.exceptions.custom_exception.CustomException: Error while deleting the collection 667843591624d2699fdc8ce2
ERROR    2024-06-23 20:14:13.596 request id: app - uvicorn.protocols.http.httptools_impl:run_asgi - Exception in ASGI application

Traceback (most recent call last):

  File "/app/app/routers/collections.py", line 608, in delete_collection
    await remove_qdrant_index_async(str(collection_id))
          │                             └ '667843591624d2699fdc8ce2'
          └ <function remove_qdrant_index_async at 0x7f113d4c4310>

  File "/app/app/routers/collections.py", line 570, in remove_qdrant_index_async
    await asyncio.to_thread(remove_qdrant_index, index)
          │       │         │                    └ '667843591624d2699fdc8ce2'
          │       │         └ <function remove_qdrant_index at 0x7f113d5d4820>
          │       └ <function to_thread at 0x7f12456793f0>
          └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>

  File "/usr/local/lib/python3.10/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
                 │    │                     └ functools.partial(<built-in method run of _contextvars.Context object at 0x7f11397e1600>, <function remove_qdrant_index at 0x...
                 │    └ <method 'run_in_executor' of 'uvloop.loop.Loop' objects>
                 └ <uvloop.Loop running=True closed=False debug=False>
  File "/usr/local/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/app/app/utils/qdrant.py", line 63, in remove_qdrant_index
    qdrant_client.delete(
    │             └ <function QdrantClient.delete at 0x7f114ffcf0a0>
    └ <qdrant_client.qdrant_client.QdrantClient object at 0x7f114f82ea70>

  File "/usr/local/lib/python3.10/site-packages/qdrant_client/qdrant_client.py", line 1201, in delete
    return self._client.delete(
           │    │       └ <function QdrantRemote.delete at 0x7f114ffcc9d0>
           │    └ <qdrant_client.qdrant_remote.QdrantRemote object at 0x7f114f82e9e0>
           └ <qdrant_client.qdrant_client.QdrantClient object at 0x7f114f82ea70>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/qdrant_remote.py", line 1700, in delete
    result: Optional[types.UpdateResult] = self.openapi_client.points_api.delete_points(
            │        │     │               │    │              │          └ <function SyncPointsApi.delete_points at 0x7f1150adeb90>
            │        │     │               │    │              └ <qdrant_client.http.api.points_api.SyncPointsApi object at 0x7f114f82f0a0>
            │        │     │               │    └ <qdrant_client.http.api_client.SyncApis object at 0x7f114f82ead0>
            │        │     │               └ <qdrant_client.qdrant_remote.QdrantRemote object at 0x7f114f82e9e0>
            │        │     └ <class 'qdrant_client.http.models.models.UpdateResult'>
            │        └ <module 'qdrant_client.conversions.common_types' from '/usr/local/lib/python3.10/site-packages/qdrant_client/conversions/comm...
            └ typing.Optional
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api/points_api.py", line 1173, in delete_points
    return self._build_for_delete_points(
           │    └ <function _PointsApi._build_for_delete_points at 0x7f1150add3f0>
           └ <qdrant_client.http.api.points_api.SyncPointsApi object at 0x7f114f82f0a0>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api/points_api.py", line 206, in _build_for_delete_points
    return self.api_client.request(
           │    │          └ <function ApiClient.request at 0x7f1150aee830>
           │    └ <qdrant_client.http.api_client.ApiClient object at 0x7f114f82eb00>
           └ <qdrant_client.http.api.points_api.SyncPointsApi object at 0x7f114f82f0a0>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api_client.py", line 76, in request
    return self.send(request, type_)
           │    │    │        └ <class 'qdrant_client.http.models.models.InlineResponse2007'>
           │    │    └ <Request('POST', 'http://qdrant:6333/collections/qdr/points/delete?wait=true')>
           │    └ <function ApiClient.send at 0x7f1150aee950>
           └ <qdrant_client.http.api_client.ApiClient object at 0x7f114f82eb00>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api_client.py", line 99, in send
    raise UnexpectedResponse.for_response(response)
          │                  │            └ <Response [404 Not Found]>
          │                  └ <staticmethod(<function UnexpectedResponse.for_response at 0x7f1150aee4d0>)>
          └ <class 'qdrant_client.http.exceptions.UnexpectedResponse'>

qdrant_client.http.exceptions.UnexpectedResponse: Unexpected Response: 404 (Not Found)
Raw response content:
b'{"status":{"error":"Not found: Collection `qdr` doesn\'t exist!"},"time":0.00003869}'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/app/app/routers/collections.py", line 610, in delete_collection
    raise HTTPException(
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 400: Error while deleting the collection 667843591624d2699fdc8ce2 files from qdrant


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x7f1246091510>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7f12462311b0>
           └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f1246230820>
    └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7f12461c5f90>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
    │    └ <function subprocess_started at 0x7f12454665f0>
    └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7f124565d210>>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
           │       │   │    └ <function Server.serve at 0x7f1245465b40>
           │       │   └ <uvicorn.server.Server object at 0x7f124565d210>
           │       └ <function run at 0x7f12458de7a0>
           └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>
  File "/usr/local/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f1244f7c350>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>
> File "/usr/local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 399, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f12457166e0>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398cb5...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f12461bc520>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f12457166e0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398cb5...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
  File "/usr/local/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398cb5...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f113bbbad70>
          └ <fastapi.applications.FastAPI object at 0x7f12461bc520>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f113989cc10>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f113bbbae60>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f113bbbad70>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f113989cc10>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │                            │    │    └ <starlette.requests.Request object at 0x7f11398cb760>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7f113bb99f90>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f113bbbae60>
          └ <function wrap_app_handling_exceptions at 0x7f12164015a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113989c8b0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          └ <fastapi.routing.APIRouter object at 0x7f113bb99f90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113989c8b0>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7f113bb99f90>>
          └ <fastapi.routing.APIRouter object at 0x7f113bb99f90>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113989c8b0>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │     └ <function Route.handle at 0x7f1216402950>
          └ APIRoute(path='/collections/{collection_id}', name='delete_collection', methods=['DELETE'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113989c8b0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │    └ <function request_response.<locals>.app at 0x7f113bb9f370>
          └ APIRoute(path='/collections/{collection_id}', name='delete_collection', methods=['DELETE'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113989c8b0>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          │                            │    └ <starlette.requests.Request object at 0x7f11398cb970>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7f113989cb80>
          └ <function wrap_app_handling_exceptions at 0x7f12164015a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f113989caf0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f11398...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.2', 8100), 'c...
          └ <function request_response.<locals>.app.<locals>.app at 0x7f113989cb80>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f11398cb970>
                     └ <function get_request_handler.<locals>.app at 0x7f113bb9f400>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f12164037f0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'collection_id': '667843591624d2699fdc8ce2'}
                 │         └ <function delete_collection at 0x7f113d4c4430>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f113bb7dde0>

  File "/app/app/routers/collections.py", line 629, in delete_collection
    raise CustomException(
          └ <class 'app.exceptions.custom_exception.CustomException'>

app.exceptions.custom_exception.CustomException: Error while deleting the collection 667843591624d2699fdc8ce2
INFO     2024-06-23 20:14:13.885 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:56846 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:14:28.068 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:14:28.070 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:14:28.174 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:14:28.175 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:16:28.870 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 20:16:28.871 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 20:16:28.872 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:16:28.873 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:16:57.149 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 20:16:57.418 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 20:16:57.508 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 20:16:57.513 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:16:57.514 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:18:06.911 request id: app - httpx._client:_send_single_request - HTTP Request: PUT http://qdrant:6333/collections/qdr/index?wait=true "HTTP/1.1 404 Not Found"
INFO     2024-06-23 20:18:06.940 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.6:54414 - "POST /api/collections/ HTTP/1.0" 500
ERROR    2024-06-23 20:18:06.941 request id: app - uvicorn.protocols.http.httptools_impl:run_asgi - Exception in ASGI application

Traceback (most recent call last):

  File "/app/app/routers/collections.py", line 171, in create_collection
    await create_qdrant_collection_index_async(str(created_collection.id))
          │                                        │                  └ ObjectId('667882fe8118c58c98b8ec92')
          │                                        └ Collection(id=ObjectId('667882fe8118c58c98b8ec92'), revision_id=None, name='Contrats', created_at=datetime.datetime(2024, 6, ...
          └ <function create_qdrant_collection_index_async at 0x7f1f370cdab0>

  File "/app/app/routers/collections.py", line 106, in create_qdrant_collection_index_async
    await asyncio.to_thread(create_qdrant_collection_index, index)
          │       │         │                               └ '667882fe8118c58c98b8ec92'
          │       │         └ <function create_qdrant_collection_index at 0x7f1f493593f0>
          │       └ <function to_thread at 0x7f203f1d93f0>
          └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>

  File "/usr/local/lib/python3.10/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
                 │    │                     └ functools.partial(<built-in method run of _contextvars.Context object at 0x7f1f342b5b80>, <function create_qdrant_collection_...
                 │    └ <method 'run_in_executor' of 'uvloop.loop.Loop' objects>
                 └ <uvloop.Loop running=True closed=False debug=False>
  File "/usr/local/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/app/app/utils/qdrant.py", line 25, in create_qdrant_collection_index
    qdrant_client.create_payload_index(
    │             └ <function QdrantClient.create_payload_index at 0x7f1f49af7be0>
    └ <qdrant_client.qdrant_client.QdrantClient object at 0x7f1f49356a10>

  File "/usr/local/lib/python3.10/site-packages/qdrant_client/qdrant_client.py", line 2032, in create_payload_index
    return self._client.create_payload_index(
           │    │       └ <function QdrantRemote.create_payload_index at 0x7f1f49af5630>
           │    └ <qdrant_client.qdrant_remote.QdrantRemote object at 0x7f1f49356980>
           └ <qdrant_client.qdrant_client.QdrantClient object at 0x7f1f49356a10>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/qdrant_remote.py", line 2504, in create_payload_index
    ] = self.openapi_client.collections_api.create_field_index(
        │    │              │               └ <function SyncCollectionsApi.create_field_index at 0x7f1f4a6040d0>
        │    │              └ <qdrant_client.http.api.collections_api.SyncCollectionsApi object at 0x7f1f493570d0>
        │    └ <qdrant_client.http.api_client.SyncApis object at 0x7f1f49356a70>
        └ <qdrant_client.qdrant_remote.QdrantRemote object at 0x7f1f49356980>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api/collections_api.py", line 1186, in create_field_index
    return self._build_for_create_field_index(
           │    └ <function _CollectionsApi._build_for_create_field_index at 0x7f1f4a76a200>
           └ <qdrant_client.http.api.collections_api.SyncCollectionsApi object at 0x7f1f493570d0>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api/collections_api.py", line 150, in _build_for_create_field_index
    return self.api_client.request(
           │    │          └ <function ApiClient.request at 0x7f1f4a616830>
           │    └ <qdrant_client.http.api_client.ApiClient object at 0x7f1f49356aa0>
           └ <qdrant_client.http.api.collections_api.SyncCollectionsApi object at 0x7f1f493570d0>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api_client.py", line 76, in request
    return self.send(request, type_)
           │    │    │        └ <class 'qdrant_client.http.models.models.InlineResponse2007'>
           │    │    └ <Request('PUT', 'http://qdrant:6333/collections/qdr/index?wait=true')>
           │    └ <function ApiClient.send at 0x7f1f4a616950>
           └ <qdrant_client.http.api_client.ApiClient object at 0x7f1f49356aa0>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api_client.py", line 99, in send
    raise UnexpectedResponse.for_response(response)
          │                  │            └ <Response [404 Not Found]>
          │                  └ <staticmethod(<function UnexpectedResponse.for_response at 0x7f1f4a6164d0>)>
          └ <class 'qdrant_client.http.exceptions.UnexpectedResponse'>

qdrant_client.http.exceptions.UnexpectedResponse: Unexpected Response: 404 (Not Found)
Raw response content:
b'{"status":{"error":"Not found: Collection `qdr` doesn\'t exist!"},"time":0.000189191}'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/app/app/routers/collections.py", line 173, in create_collection
    raise HTTPException(
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 400: Error while creating the collection Contrats in qdrant


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x7f203fbf1510>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7f203fd911b0>
           └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f203fd90820>
    └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7f203fd25f90>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
    │    └ <function subprocess_started at 0x7f203efc65f0>
    └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7f203f1bd210>>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
           │       │   │    └ <function Server.serve at 0x7f203efc5b40>
           │       │   └ <uvicorn.server.Server object at 0x7f203f1bd210>
           │       └ <function run at 0x7f203f43e7a0>
           └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>
  File "/usr/local/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f203eadc350>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>
> File "/usr/local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 399, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f203f2766e0>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343acb...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f203fd1c520>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f203f2766e0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343acb...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
  File "/usr/local/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343acb...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f1f356b6ce0>
          └ <fastapi.applications.FastAPI object at 0x7f203fd1c520>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f1f342a31c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f1f356b6dd0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f1f356b6ce0>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f1f342a31c0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          │                            │    │    └ <starlette.requests.Request object at 0x7f1f343acc70>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7f1f35695f00>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f1f356b6dd0>
          └ <function wrap_app_handling_exceptions at 0x7f200ff755a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f1f342a3250>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          └ <fastapi.routing.APIRouter object at 0x7f1f35695f00>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f1f342a3250>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7f1f35695f00>>
          └ <fastapi.routing.APIRouter object at 0x7f1f35695f00>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f1f342a3250>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          │     └ <function Route.handle at 0x7f200ff76950>
          └ APIRoute(path='/collections/', name='create_collection', methods=['POST'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f1f342a3250>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          │    └ <function request_response.<locals>.app at 0x7f1f356989d0>
          └ APIRoute(path='/collections/', name='create_collection', methods=['POST'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f1f342a3250>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          │                            │    └ <starlette.requests.Request object at 0x7f1f343acee0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7f1f342a32e0>
          └ <function wrap_app_handling_exceptions at 0x7f200ff755a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f1f342a3370>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          └ <function request_response.<locals>.app.<locals>.app at 0x7f1f342a32e0>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f1f343acee0>
                     └ <function get_request_handler.<locals>.app at 0x7f1f356988b0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f200ff777f0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'collection': CreateCollectionRequest(name='Contrats')}
                 │         └ <function create_collection at 0x7f1f370cd5a0>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f1f35696bc0>

  File "/app/app/routers/collections.py", line 180, in create_collection
    raise CustomException(
          └ <class 'app.exceptions.custom_exception.CustomException'>

app.exceptions.custom_exception.CustomException: An error occurred while creating the collection {collection.name}
ERROR    2024-06-23 20:18:07.046 request id: app - uvicorn.protocols.http.httptools_impl:run_asgi - Exception in ASGI application

Traceback (most recent call last):

  File "/app/app/routers/collections.py", line 171, in create_collection
    await create_qdrant_collection_index_async(str(created_collection.id))
          │                                        │                  └ ObjectId('667882fe8118c58c98b8ec92')
          │                                        └ Collection(id=ObjectId('667882fe8118c58c98b8ec92'), revision_id=None, name='Contrats', created_at=datetime.datetime(2024, 6, ...
          └ <function create_qdrant_collection_index_async at 0x7f1f370cdab0>

  File "/app/app/routers/collections.py", line 106, in create_qdrant_collection_index_async
    await asyncio.to_thread(create_qdrant_collection_index, index)
          │       │         │                               └ '667882fe8118c58c98b8ec92'
          │       │         └ <function create_qdrant_collection_index at 0x7f1f493593f0>
          │       └ <function to_thread at 0x7f203f1d93f0>
          └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>

  File "/usr/local/lib/python3.10/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
                 │    │                     └ functools.partial(<built-in method run of _contextvars.Context object at 0x7f1f342b5b80>, <function create_qdrant_collection_...
                 │    └ <method 'run_in_executor' of 'uvloop.loop.Loop' objects>
                 └ <uvloop.Loop running=True closed=False debug=False>
  File "/usr/local/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             │        │            └ None
             │        └ None
             └ None

  File "/app/app/utils/qdrant.py", line 25, in create_qdrant_collection_index
    qdrant_client.create_payload_index(
    │             └ <function QdrantClient.create_payload_index at 0x7f1f49af7be0>
    └ <qdrant_client.qdrant_client.QdrantClient object at 0x7f1f49356a10>

  File "/usr/local/lib/python3.10/site-packages/qdrant_client/qdrant_client.py", line 2032, in create_payload_index
    return self._client.create_payload_index(
           │    │       └ <function QdrantRemote.create_payload_index at 0x7f1f49af5630>
           │    └ <qdrant_client.qdrant_remote.QdrantRemote object at 0x7f1f49356980>
           └ <qdrant_client.qdrant_client.QdrantClient object at 0x7f1f49356a10>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/qdrant_remote.py", line 2504, in create_payload_index
    ] = self.openapi_client.collections_api.create_field_index(
        │    │              │               └ <function SyncCollectionsApi.create_field_index at 0x7f1f4a6040d0>
        │    │              └ <qdrant_client.http.api.collections_api.SyncCollectionsApi object at 0x7f1f493570d0>
        │    └ <qdrant_client.http.api_client.SyncApis object at 0x7f1f49356a70>
        └ <qdrant_client.qdrant_remote.QdrantRemote object at 0x7f1f49356980>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api/collections_api.py", line 1186, in create_field_index
    return self._build_for_create_field_index(
           │    └ <function _CollectionsApi._build_for_create_field_index at 0x7f1f4a76a200>
           └ <qdrant_client.http.api.collections_api.SyncCollectionsApi object at 0x7f1f493570d0>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api/collections_api.py", line 150, in _build_for_create_field_index
    return self.api_client.request(
           │    │          └ <function ApiClient.request at 0x7f1f4a616830>
           │    └ <qdrant_client.http.api_client.ApiClient object at 0x7f1f49356aa0>
           └ <qdrant_client.http.api.collections_api.SyncCollectionsApi object at 0x7f1f493570d0>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api_client.py", line 76, in request
    return self.send(request, type_)
           │    │    │        └ <class 'qdrant_client.http.models.models.InlineResponse2007'>
           │    │    └ <Request('PUT', 'http://qdrant:6333/collections/qdr/index?wait=true')>
           │    └ <function ApiClient.send at 0x7f1f4a616950>
           └ <qdrant_client.http.api_client.ApiClient object at 0x7f1f49356aa0>
  File "/usr/local/lib/python3.10/site-packages/qdrant_client/http/api_client.py", line 99, in send
    raise UnexpectedResponse.for_response(response)
          │                  │            └ <Response [404 Not Found]>
          │                  └ <staticmethod(<function UnexpectedResponse.for_response at 0x7f1f4a6164d0>)>
          └ <class 'qdrant_client.http.exceptions.UnexpectedResponse'>

qdrant_client.http.exceptions.UnexpectedResponse: Unexpected Response: 404 (Not Found)
Raw response content:
b'{"status":{"error":"Not found: Collection `qdr` doesn\'t exist!"},"time":0.000189191}'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/app/app/routers/collections.py", line 173, in create_collection
    raise HTTPException(
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 400: Error while creating the collection Contrats in qdrant


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 116, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 4
               │     └ 7
               └ <function _main at 0x7f203fbf1510>
  File "/usr/local/lib/python3.10/multiprocessing/spawn.py", line 129, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 4
           │    └ <function BaseProcess._bootstrap at 0x7f203fd911b0>
           └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 314, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x7f203fd90820>
    └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x7f203fd25f90>, 'target': <bound method Server.run of <uvicorn.server.Server obj...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
    │    └ <function subprocess_started at 0x7f203efc65f0>
    └ <SpawnProcess name='SpawnProcess-1' parent=1 started>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x7f203f1bd210>>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/server.py", line 65, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=3, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('0.0.0.0', 8100)>]
           │       │   │    └ <function Server.serve at 0x7f203efc5b40>
           │       │   └ <uvicorn.server.Server object at 0x7f203f1bd210>
           │       └ <function run at 0x7f203f43e7a0>
           └ <module 'asyncio' from '/usr/local/lib/python3.10/asyncio/__init__.py'>
  File "/usr/local/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
           │    │                  └ <coroutine object Server.serve at 0x7f203eadc350>
           │    └ <method 'run_until_complete' of 'uvloop.loop.Loop' objects>
           └ <uvloop.Loop running=True closed=False debug=False>
> File "/usr/local/lib/python3.10/site-packages/uvicorn/protocols/http/httptools_impl.py", line 399, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f203f2766e0>
  File "/usr/local/lib/python3.10/site-packages/uvicorn/middleware/proxy_headers.py", line 70, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343acb...
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
                 │    └ <fastapi.applications.FastAPI object at 0x7f203fd1c520>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x7f203f2766e0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343acb...
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
  File "/usr/local/lib/python3.10/site-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343acb...
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f1f356b6ce0>
          └ <fastapi.applications.FastAPI object at 0x7f203fd1c520>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f1f342a31c0>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f1f356b6dd0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x7f1f356b6ce0>
  File "/usr/local/lib/python3.10/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x7f1f342a31c0>
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          │                            │    │    └ <starlette.requests.Request object at 0x7f1f343acc70>
          │                            │    └ <fastapi.routing.APIRouter object at 0x7f1f35695f00>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f1f356b6dd0>
          └ <function wrap_app_handling_exceptions at 0x7f200ff755a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f1f342a3250>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          └ <fastapi.routing.APIRouter object at 0x7f1f35695f00>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 758, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f1f342a3250>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x7f1f35695f00>>
          └ <fastapi.routing.APIRouter object at 0x7f1f35695f00>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 778, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f1f342a3250>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          │     └ <function Route.handle at 0x7f200ff76950>
          └ APIRoute(path='/collections/', name='create_collection', methods=['POST'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 299, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f1f342a3250>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          │    └ <function request_response.<locals>.app at 0x7f1f356989d0>
          └ APIRoute(path='/collections/', name='create_collection', methods=['POST'])
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 79, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f1f342a3250>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          │                            │    └ <starlette.requests.Request object at 0x7f1f343acee0>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x7f1f342a32e0>
          └ <function wrap_app_handling_exceptions at 0x7f200ff755a0>
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x7f1f342a3370>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x7f1f343...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.0', 'server': ('172.28.0.4', 8100), 'c...
          └ <function request_response.<locals>.app.<locals>.app at 0x7f1f342a32e0>
  File "/usr/local/lib/python3.10/site-packages/starlette/routing.py", line 74, in app
    response = await func(request)
                     │    └ <starlette.requests.Request object at 0x7f1f343acee0>
                     └ <function get_request_handler.<locals>.app at 0x7f1f356988b0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x7f200ff777f0>
  File "/usr/local/lib/python3.10/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'collection': CreateCollectionRequest(name='Contrats')}
                 │         └ <function create_collection at 0x7f1f370cd5a0>
                 └ <fastapi.dependencies.models.Dependant object at 0x7f1f35696bc0>

  File "/app/app/routers/collections.py", line 180, in create_collection
    raise CustomException(
          └ <class 'app.exceptions.custom_exception.CustomException'>

app.exceptions.custom_exception.CustomException: An error occurred while creating the collection {collection.name}
INFO     2024-06-23 20:18:25.883 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.6:49668 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:18:25.919 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.6:49678 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:19:35.773 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:19:35.774 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:19:35.876 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:19:35.878 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:30:13.393 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 20:30:13.394 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 20:30:13.394 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:30:13.395 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:30:34.626 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 20:30:34.885 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 20:30:34.973 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 20:30:34.977 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:30:34.979 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:30:47.602 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:51460 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:30:47.633 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:51468 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:34:22.769 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:41802 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:34:22.788 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:41814 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:34:55.814 request id: app - httpx._client:_send_single_request - HTTP Request: PUT http://qdrant:6333/collections/qdr/index?wait=true "HTTP/1.1 200 OK"
INFO     2024-06-23 20:34:55.825 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:37556 - "POST /api/collections/ HTTP/1.0" 201
INFO     2024-06-23 20:34:55.848 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:37566 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:35:02.767 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:41722 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 20:35:02.771 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:41720 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:35:02.804 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:41728 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 20:35:02.838 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:41740 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:35:30.260 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:48056 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 20:35:30.267 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:48062 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 20:35:30.278 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:48052 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:35:30.300 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:48066 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:35:44.184 request id: app - httpx._client:_send_single_request - HTTP Request: GET http://qdrant:6333/collections/qdr/exists "HTTP/1.1 200 OK"
INFO     2024-06-23 20:35:44.750 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO     2024-06-23 20:35:44.771 request id: app - httpx._client:_send_single_request - HTTP Request: POST http://qdrant:6333/collections/qdr/points/search "HTTP/1.1 200 OK"
INFO     2024-06-23 20:35:44.779 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:59002 - "POST /api/chat/message HTTP/1.0" 200
INFO     2024-06-23 20:36:05.073 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:42156 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:36:05.099 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:42160 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:36:13.367 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:49396 - "POST /api/collections/667886ef09305f3d5c0ca88e/files/upload HTTP/1.0" 200
INFO     2024-06-23 20:36:13.416 request id: None - app.ds.parsing_loading_utils:ingest_data - Ingestion step 1 : Parsing
INFO     2024-06-23 20:36:15.156 request id: None - app.ds.parsing_loading_utils:ingest_data - Ingestion step 2 : Reliability
INFO     2024-06-23 20:36:16.466 request id: None - app.ds.parsing_loading_utils:ingest_data - Step 2 : Recording
INFO     2024-06-23 20:36:16.468 request id: None - app.ds.parsing_loading_utils:ingest_data -                type  ... need_fiab
0  CompositeElement  ...     False
1  CompositeElement  ...     False
2  CompositeElement  ...     False
3  CompositeElement  ...     False
4  CompositeElement  ...     False
5  CompositeElement  ...     False
6  CompositeElement  ...     False
7  CompositeElement  ...     False
8  CompositeElement  ...     False

[9 rows x 9 columns]
WARNING  2024-06-23 20:36:16.545 request id: app - warnings:_showwarnmsg - /app/app/ds/parsing_loading_utils.py:287: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df["index"] = index

INFO     2024-06-23 20:36:16.946 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO     2024-06-23 20:36:17.227 request id: app - httpx._client:_send_single_request - HTTP Request: PUT http://qdrant:6333/collections/qdr/points?wait=true "HTTP/1.1 200 OK"
INFO     2024-06-23 20:36:17.257 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:49408 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:36:28.117 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:39656 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 20:36:28.145 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:39654 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:36:28.167 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:39664 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 20:36:28.190 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:39668 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:36:39.939 request id: app - httpx._client:_send_single_request - HTTP Request: GET http://qdrant:6333/collections/qdr/exists "HTTP/1.1 200 OK"
INFO     2024-06-23 20:36:40.282 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO     2024-06-23 20:36:40.309 request id: app - httpx._client:_send_single_request - HTTP Request: POST http://qdrant:6333/collections/qdr/points/search "HTTP/1.1 200 OK"
INFO     2024-06-23 20:36:40.382 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.5:52580 - "POST /api/chat/message HTTP/1.0" 200
INFO     2024-06-23 20:36:41.280 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO     2024-06-23 20:39:50.330 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:39:50.334 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:39:50.437 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:39:50.440 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:40:43.787 request id: app - uvicorn.server:_serve - Started server process [7]
INFO     2024-06-23 20:40:43.788 request id: app - uvicorn.server:_serve - Started server process [7]
INFO     2024-06-23 20:40:43.790 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:40:43.791 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:40:43.928 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 20:40:44.174 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 20:40:44.293 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 20:40:44.316 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:40:44.317 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:41:36.274 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:41:36.276 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:41:36.378 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:41:36.379 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:42:18.821 request id: app - uvicorn.server:_serve - Started server process [7]
INFO     2024-06-23 20:42:18.823 request id: app - uvicorn.server:_serve - Started server process [7]
INFO     2024-06-23 20:42:18.824 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:42:18.825 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:42:18.911 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 20:42:19.129 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 20:42:19.203 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 20:42:19.208 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:42:19.210 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:42:26.608 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:42:26.614 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:42:26.732 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:42:26.735 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:43:15.945 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 20:43:15.947 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 20:43:15.948 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:43:15.949 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:43:16.049 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 20:43:16.307 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 20:43:16.381 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 20:43:16.385 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:43:16.386 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:44:19.844 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:44:19.846 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:44:19.948 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:44:19.951 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:44:58.550 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 20:44:58.551 request id: app - uvicorn.server:_serve - Started server process [8]
INFO     2024-06-23 20:44:58.552 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:44:58.552 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:44:58.639 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 20:44:58.819 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 20:44:58.875 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 20:44:58.879 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:44:58.886 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:47:45.466 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:47:45.469 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:47:45.580 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:47:45.581 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:49:26.384 request id: app - uvicorn.server:_serve - Started server process [7]
INFO     2024-06-23 20:49:26.385 request id: app - uvicorn.server:_serve - Started server process [7]
INFO     2024-06-23 20:49:26.386 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:49:26.386 request id: app - uvicorn.lifespan.on:startup - Waiting for application startup.
INFO     2024-06-23 20:49:26.480 request id: app - app.config.mongo:init - Successfully connected to mongodb database
WARNING  2024-06-23 20:49:26.688 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator _BinMapper from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

WARNING  2024-06-23 20:49:26.743 request id: app - warnings:_showwarnmsg - /usr/local/lib/python3.10/site-packages/sklearn/base.py:376: InconsistentVersionWarning: Trying to unpickle estimator HistGradientBoostingClassifier from version 1.4.2 when using version 1.5.0. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/model_persistence.html#security-maintainability-limitations
  warnings.warn(

INFO     2024-06-23 20:49:26.748 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:49:26.749 request id: app - uvicorn.lifespan.on:startup - Application startup complete.
INFO     2024-06-23 20:49:56.245 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:49868 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 20:49:56.250 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:49882 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 20:49:56.268 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:49856 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:49:56.292 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:49896 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:50:08.944 request id: app - httpx._client:_send_single_request - HTTP Request: GET http://qdrant:6333/collections/qdr/exists "HTTP/1.1 200 OK"
INFO     2024-06-23 20:50:09.288 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO     2024-06-23 20:50:09.362 request id: app - httpx._client:_send_single_request - HTTP Request: POST http://qdrant:6333/collections/qdr/points/search "HTTP/1.1 200 OK"
INFO     2024-06-23 20:50:09.437 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:39532 - "POST /api/chat/message HTTP/1.0" 200
INFO     2024-06-23 20:50:09.988 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO     2024-06-23 20:51:04.417 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:47836 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 20:51:04.430 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:47852 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 20:51:04.437 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:47832 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:51:04.465 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:47858 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:51:50.380 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:35202 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 20:51:50.398 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:35210 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 20:51:50.407 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:35206 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:51:50.496 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:35216 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:52:02.951 request id: app - httpx._client:_send_single_request - HTTP Request: GET http://qdrant:6333/collections/qdr/exists "HTTP/1.1 200 OK"
INFO     2024-06-23 20:52:03.283 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO     2024-06-23 20:52:03.301 request id: app - httpx._client:_send_single_request - HTTP Request: POST http://qdrant:6333/collections/qdr/points/search "HTTP/1.1 200 OK"
INFO     2024-06-23 20:52:03.377 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:46538 - "POST /api/chat/message HTTP/1.0" 200
INFO     2024-06-23 20:52:04.117 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO     2024-06-23 20:52:41.342 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:48876 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 20:52:41.352 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:48888 - "GET /api/settings/workflows HTTP/1.0" 200
INFO     2024-06-23 20:52:41.372 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:48880 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:52:41.396 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:48894 - "GET /api/collections/ HTTP/1.0" 200
INFO     2024-06-23 20:52:51.768 request id: app - httpx._client:_send_single_request - HTTP Request: GET http://qdrant:6333/collections/qdr/exists "HTTP/1.1 200 OK"
INFO     2024-06-23 20:52:52.054 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO     2024-06-23 20:52:52.075 request id: app - httpx._client:_send_single_request - HTTP Request: POST http://qdrant:6333/collections/qdr/points/search "HTTP/1.1 200 OK"
INFO     2024-06-23 20:52:52.143 request id: app - uvicorn.protocols.http.httptools_impl:send - 172.28.0.7:50014 - "POST /api/chat/message HTTP/1.0" 200
INFO     2024-06-23 20:52:53.025 request id: app - httpx._client:_send_single_request - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO     2024-06-23 20:54:37.564 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:54:37.566 request id: app - uvicorn.server:shutdown - Shutting down
INFO     2024-06-23 20:54:37.668 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
INFO     2024-06-23 20:54:37.669 request id: app - uvicorn.lifespan.on:shutdown - Waiting for application shutdown.
